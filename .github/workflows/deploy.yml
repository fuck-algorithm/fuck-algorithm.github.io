name: Deploy to GitHub Pages

on:
  push:
    branches: [ main ]
  workflow_dispatch:

# è®¾ç½®æƒé™
permissions:
  contents: write

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout ğŸ›ï¸
        uses: actions/checkout@v3

      - name: Setup Node.js ğŸ“¦
        uses: actions/setup-node@v3
        with:
          node-version: '16'
          
      - name: Install Dependencies ğŸ”§
        run: |
          npm install
          
      - name: Debug Environment ğŸ”
        run: |
          node -v
          npm -v
          ls -la
          cat package.json
          
      - name: Build ğŸ—ï¸
        run: |
          mkdir -p dist
          cp public/index.html dist/
          
          # åˆ›å»ºæ›´äº’åŠ¨çš„main.js
          cat > dist/main.js << 'EOL'
          // æ·»åŠ ä¸€äº›äº’åŠ¨å…ƒç´ 
          document.addEventListener('DOMContentLoaded', function() {
            // è·å–å½“å‰æ—¶é—´
            const now = new Date();
            const footer = document.createElement('footer');
            footer.style.marginTop = '40px';
            footer.style.fontSize = '0.9rem';
            footer.style.color = '#777';
            footer.innerHTML = 'æœ€åæ›´æ–°æ—¶é—´: ' + now.toLocaleString();
            
            // éšæœºç®—æ³•å°çŸ¥è¯†
            const tips = [
              "å¿«é€Ÿæ’åºçš„å¹³å‡æ—¶é—´å¤æ‚åº¦æ˜¯O(n log n)",
              "åŠ¨æ€è§„åˆ’é€šå¸¸ç”¨äºè§£å†³å…·æœ‰é‡å å­é—®é¢˜çš„ä¼˜åŒ–é—®é¢˜",
              "äºŒåˆ†æŸ¥æ‰¾è¦æ±‚æ•°ç»„å¿…é¡»æ˜¯æœ‰åºçš„",
              "å¹¿åº¦ä¼˜å…ˆæœç´¢é€šå¸¸ä½¿ç”¨é˜Ÿåˆ—å®ç°",
              "æ·±åº¦ä¼˜å…ˆæœç´¢é€šå¸¸ä½¿ç”¨æ ˆæˆ–é€’å½’å®ç°",
              "å“ˆå¸Œè¡¨çš„å¹³å‡æŸ¥æ‰¾æ—¶é—´å¤æ‚åº¦æ˜¯O(1)"
            ];
            
            const randomTip = tips[Math.floor(Math.random() * tips.length)];
            const tipElement = document.createElement('div');
            tipElement.className = 'coming-soon';
            tipElement.innerHTML = '<h3>æ¯æ—¥ç®—æ³•å°çŸ¥è¯†</h3><p>' + randomTip + '</p>';
            
            const container = document.querySelector('.container');
            container.insertBefore(tipElement, document.querySelector('.github-link'));
            container.appendChild(footer);
          });
          EOL
        
      - name: Deploy ğŸš€
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          folder: dist
          branch: gh-pages
          clean: true
          token: ${{ secrets.GITHUB_TOKEN }} 