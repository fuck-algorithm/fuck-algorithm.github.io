name: Deploy to GitHub Pages

on:
  push:
    branches: [ main ]
  workflow_dispatch:

# è®¾ç½®æƒé™
permissions:
  contents: write

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout ğŸ›ï¸
        uses: actions/checkout@v3

      - name: Setup Node.js ğŸ“¦
        uses: actions/setup-node@v3
        with:
          node-version: '16'
          cache: 'npm'
          
      - name: Install Dependencies ğŸ”§
        run: |
          npm install
          
      - name: Debug Build Environment ğŸ”
        run: |
          echo "Node version: $(node -v)"
          echo "NPM version: $(npm -v)"
          echo "Directory structure:"
          ls -la

      - name: Create Build Directory ğŸ“
        run: |
          # åˆ›å»ºæ„å»ºç›®å½•
          mkdir -p dist
          
          # å¤åˆ¶å…¬å…±èµ„æº
          cp -r public/* dist/
          
          # åˆ›å»ºCSSæ–‡ä»¶
          cat > dist/styles.css << 'EOL'
          body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f5f5f7;
            color: #333;
            line-height: 1.5;
          }
          
          .App {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
          }
          
          .App-header {
            background-color: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
          }
          
          .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            max-width: 1200px;
            margin: 0 auto;
            height: 70px;
          }
          
          .logo h1 {
            margin: 0;
            font-size: 1.5rem;
            color: #1e1e2e;
          }
          
          .nav-links {
            display: flex;
            gap: 20px;
          }
          
          .nav-links a {
            text-decoration: none;
            color: #555;
            font-weight: 500;
            transition: color 0.3s;
          }
          
          .nav-links a:hover {
            color: #61dafb;
          }
          
          main {
            flex: 1;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            width: 100%;
            box-sizing: border-box;
          }
          
          footer {
            background-color: #1e1e2e;
            color: white;
            padding: 40px 20px;
          }
          
          .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            align-items: center;
          }
          
          .footer-links {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
          }
          
          .footer-links a {
            color: white;
            text-decoration: none;
            transition: opacity 0.3s;
          }
          
          .footer-links a:hover {
            opacity: 0.8;
          }
          
          /* é¦–é¡µæ ·å¼ */
          .hero {
            padding: 80px 20px;
            text-align: center;
            background-color: #1e1e2e;
            color: white;
            margin: -20px -20px 0;
          }
          
          .hero-content h1 {
            font-size: 3rem;
            margin-bottom: 0.5rem;
          }
          
          .slogan {
            font-size: 1.5rem;
            margin-bottom: 2rem;
            opacity: 0.9;
          }
          
          .cta-button {
            display: inline-block;
            background-color: #61dafb;
            color: #1e1e2e;
            padding: 12px 24px;
            border-radius: 4px;
            text-decoration: none;
            font-weight: 600;
            transition: background-color 0.3s;
          }
          
          .cta-button:hover {
            background-color: #4fa8d8;
          }
          
          .products, .problems, .about {
            padding: 60px 0;
          }
          
          .products h2, .problems h2, .about h2 {
            text-align: center;
            margin-bottom: 40px;
            font-size: 2rem;
            color: #1e1e2e;
          }
          
          .product-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 30px;
          }
          
          .product-card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            padding: 30px;
            text-align: center;
            transition: transform 0.3s, box-shadow 0.3s;
          }
          
          .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 12px rgba(0,0,0,0.15);
          }
          
          .product-card h3 {
            margin-top: 0;
            color: #1e1e2e;
          }
          
          .product-link {
            display: inline-block;
            margin-top: 20px;
            background-color: #1e1e2e;
            color: white;
            padding: 8px 16px;
            border-radius: 4px;
            text-decoration: none;
            font-weight: 500;
            transition: background-color 0.3s;
          }
          
          .product-link:hover {
            background-color: #333344;
          }
          
          .about p {
            max-width: 800px;
            margin: 0 auto 20px;
            text-align: center;
            font-size: 1.1rem;
            line-height: 1.6;
          }
          
          /* é¢˜è§£åˆ—è¡¨æ ·å¼ */
          .problem-list {
            padding: 40px 0;
          }
          
          .subtitle {
            text-align: center;
            margin-bottom: 30px;
            color: #666;
          }
          
          .filters {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 30px;
            gap: 10px;
            flex-wrap: wrap;
          }
          
          .filter-label {
            margin-right: 10px;
            font-weight: 500;
          }
          
          .filter-btn {
            border: none;
            background-color: #f0f0f0;
            color: #555;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
          }
          
          .filter-btn:hover, .filter-btn.active {
            background-color: #1e1e2e;
            color: white;
          }
          
          .filter-btn.easy {
            border: 1px solid #4caf50;
          }
          
          .filter-btn.medium {
            border: 1px solid #ff9800;
          }
          
          .filter-btn.hard {
            border: 1px solid #f44336;
          }
          
          .problem-table-container {
            max-width: 100%;
            overflow-x: auto;
          }
          
          .problem-table {
            width: 100%;
            border-collapse: collapse;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            background-color: white;
            border-radius: 8px;
            overflow: hidden;
          }
          
          .problem-table th, .problem-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
          }
          
          .problem-table th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: #1e1e2e;
          }
          
          .problem-table tr:last-child td {
            border-bottom: none;
          }
          
          .problem-table tr:hover {
            background-color: #f5f5f7;
          }
          
          .difficulty-tag {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.85rem;
            font-weight: 500;
          }
          
          .difficulty-tag.easy {
            background-color: #e8f5e9;
            color: #4caf50;
          }
          
          .difficulty-tag.medium {
            background-color: #fff3e0;
            color: #ff9800;
          }
          
          .difficulty-tag.hard {
            background-color: #ffebee;
            color: #f44336;
          }
          
          .view-btn {
            display: inline-block;
            background-color: #1e1e2e;
            color: white;
            padding: 6px 12px;
            border-radius: 4px;
            text-decoration: none;
            font-size: 0.85rem;
            transition: background-color 0.3s;
          }
          
          .view-btn:hover {
            background-color: #333344;
          }
          
          /* 404é¡µé¢æ ·å¼ */
          .not-found {
            text-align: center;
            padding: 100px 20px;
          }
          
          .not-found h1 {
            font-size: 120px;
            margin: 0;
            color: #1e1e2e;
            line-height: 1;
          }
          
          .not-found h2 {
            font-size: 2rem;
            margin-bottom: 20px;
            color: #1e1e2e;
          }
          
          .not-found p {
            font-size: 1.2rem;
            margin-bottom: 30px;
            color: #666;
          }
          EOL
          
          # åˆ›å»ºä¸»JavaScriptæ–‡ä»¶
          cat > dist/app.js << 'EOL'
          document.addEventListener('DOMContentLoaded', function() {
            // å¤„ç†é¡µé¢å†…å®¹
            displayContent();
          });
          
          function displayContent() {
            const root = document.getElementById('root');
            
            if (!root) {
              console.error('æœªæ‰¾åˆ°rootå…ƒç´ ');
              return;
            }
            
            // åˆ›å»ºAppå®¹å™¨
            const app = document.createElement('div');
            app.className = 'App';
            
            // æ·»åŠ é¡µé¢ç»“æ„
            app.innerHTML = `
              <header class="App-header">
                <nav class="navbar">
                  <div class="logo">
                    <h1>Fuck Algorithm</h1>
                  </div>
                  <div class="nav-links">
                    <a href="#">é¦–é¡µ</a>
                    <a href="#products">äº§å“</a>
                    <a href="#problems">é¢˜è§£</a>
                    <a href="#about">å…³äºæˆ‘ä»¬</a>
                    <a href="https://github.com/fuck-algorithm" target="_blank" rel="noopener noreferrer">GitHub</a>
                  </div>
                </nav>
              </header>
              
              <main>
                <section class="hero">
                  <div class="hero-content">
                    <h1>Fuck Algorithm</h1>
                    <p class="slogan">æŠŠä¸€å¤©èƒ½ç†è§£çš„çŸ¥è¯†ï¼Œç¼©çŸ­åˆ°ä¸€ä¸ªå°æ—¶</p>
                    <a href="#products" class="cta-button">æŸ¥çœ‹æˆ‘ä»¬çš„äº§å“</a>
                  </div>
                </section>
                
                <section id="products" class="products">
                  <h2>æˆ‘ä»¬çš„äº§å“</h2>
                  <div class="product-cards">
                    <div class="product-card">
                      <h3>LeetCode Hot 100</h3>
                      <p>LeetCodeæœ€çƒ­é—¨çš„100é“ç®—æ³•é¢˜ç›®è§£æ</p>
                      <a href="https://fuck-algorithm.github.io/leetcode-hot-100/" target="_blank" rel="noopener noreferrer" class="product-link">
                        ç«‹å³è®¿é—®
                      </a>
                    </div>
                  </div>
                </section>
                
                <section id="problems" class="problems">
                  <div class="problem-list">
                    <h2>æ‰€æœ‰ç®—æ³•é¢˜è§£</h2>
                    <p class="subtitle">æŒ‰é¢˜å·æ’åºçš„æ‰€æœ‰é¢˜è§£åˆ—è¡¨</p>
                    
                    <div class="filters">
                      <span class="filter-label">éš¾åº¦ç­›é€‰:</span>
                      <button class="filter-btn active">å…¨éƒ¨</button>
                      <button class="filter-btn easy">ç®€å•</button>
                      <button class="filter-btn medium">ä¸­ç­‰</button>
                      <button class="filter-btn hard">å›°éš¾</button>
                    </div>
                    
                    <div class="problem-table-container">
                      <table class="problem-table">
                        <thead>
                          <tr>
                            <th>é¢˜å·</th>
                            <th>æ ‡é¢˜</th>
                            <th>éš¾åº¦</th>
                            <th>æ“ä½œ</th>
                          </tr>
                        </thead>
                        <tbody id="problems-tbody"></tbody>
                      </table>
                    </div>
                  </div>
                </section>
                
                <section id="about" class="about">
                  <h2>å…³äºæˆ‘ä»¬</h2>
                  <p>æˆ‘ä»¬è‡´åŠ›äºæä¾›ç®€æ´æ˜äº†çš„ç®—æ³•è§£æï¼Œå¸®åŠ©å¼€å‘è€…å¿«é€Ÿç†è§£å’ŒæŒæ¡å¸¸è§ç®—æ³•é—®é¢˜ã€‚</p>
                  <p>æˆ‘ä»¬çš„ç›®æ ‡æ˜¯è®©å¤æ‚çš„ç®—æ³•å˜å¾—ç®€å•æ˜“æ‡‚ï¼Œå°†éœ€è¦ä¸€å¤©æ‰èƒ½ç†è§£çš„çŸ¥è¯†æµ“ç¼©åˆ°ä¸€å°æ—¶å†…ã€‚</p>
                </section>
              </main>
              
              <footer>
                <div class="footer-content">
                  <div class="footer-links">
                    <a href="https://github.com/fuck-algorithm" target="_blank" rel="noopener noreferrer">GitHub</a>
                    <a href="#products">äº§å“</a>
                    <a href="#problems">é¢˜è§£</a>
                    <a href="#about">å…³äºæˆ‘ä»¬</a>
                  </div>
                  <p>Â© ${new Date().getFullYear()} Fuck Algorithm. ä¿ç•™æ‰€æœ‰æƒåˆ©ã€‚</p>
                </div>
              </footer>
            `;
            
            // æ·»åŠ åˆ°DOM
            root.appendChild(app);
            
            // æ·»åŠ é¢˜ç›®æ•°æ®
            const problems = [
              {
                id: 20,
                title: 'æœ‰æ•ˆçš„æ‹¬å·',
                url: 'https://fuck-algorithm.github.io/leetcode-20-valid-parentheses/',
                difficulty: 'easy'
              },
              {
                id: 94,
                title: 'äºŒå‰æ ‘çš„ä¸­åºéå†',
                url: 'https://fuck-algorithm.github.io/leetcode-94-binary-tree-inorder-traversal/',
                difficulty: 'medium'
              },
              {
                id: 136,
                title: 'åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—',
                url: 'https://fuck-algorithm.github.io/leetcode-136-single-number/',
                difficulty: 'easy'
              },
              {
                id: 160,
                title: 'ç›¸äº¤é“¾è¡¨',
                url: 'https://fuck-algorithm.github.io/leetcode-160-intersection-of-two-linked-lists/',
                difficulty: 'easy'
              },
              {
                id: 169,
                title: 'å¤šæ•°å…ƒç´ ',
                url: 'https://fuck-algorithm.github.io/leetcode-169-majority-element/',
                difficulty: 'easy'
              },
              {
                id: 200,
                title: 'å²›å±¿æ•°é‡',
                url: 'https://fuck-algorithm.github.io/leetcode-200-number-of-islands/',
                difficulty: 'medium'
              },
              {
                id: 283,
                title: 'ç§»åŠ¨é›¶',
                url: 'https://fuck-algorithm.github.io/leetcode-283-move-zeroes/',
                difficulty: 'easy'
              },
              {
                id: 461,
                title: 'æ±‰æ˜è·ç¦»',
                url: 'https://fuck-algorithm.github.io/leetcode-461-hamming-distance/',
                difficulty: 'easy'
              }
            ];
            
            const tbody = document.getElementById('problems-tbody');
            if (tbody) {
              problems.forEach(problem => {
                const tr = document.createElement('tr');
                tr.className = `difficulty-${problem.difficulty}`;
                
                const difficultyText = problem.difficulty === 'easy' ? 'ç®€å•' : 
                                       problem.difficulty === 'medium' ? 'ä¸­ç­‰' : 'å›°éš¾';
                
                tr.innerHTML = `
                  <td>${problem.id}</td>
                  <td>${problem.title}</td>
                  <td>
                    <span class="difficulty-tag ${problem.difficulty}">
                      ${difficultyText}
                    </span>
                  </td>
                  <td>
                    <a href="${problem.url}" target="_blank" rel="noopener noreferrer" class="view-btn">
                      æŸ¥çœ‹è§£æ
                    </a>
                  </td>
                `;
                
                tbody.appendChild(tr);
              });
            }
            
            // å¤„ç†ç­›é€‰æŒ‰é’®
            const filterButtons = document.querySelectorAll('.filter-btn');
            filterButtons.forEach(button => {
              button.addEventListener('click', function() {
                // ç§»é™¤æ‰€æœ‰æŒ‰é’®çš„activeç±»
                filterButtons.forEach(btn => btn.classList.remove('active'));
                
                // æ·»åŠ å½“å‰æŒ‰é’®çš„activeç±»
                this.classList.add('active');
                
                // è·å–é€‰æ‹©çš„éš¾åº¦
                const difficulty = this.classList.contains('easy') ? 'easy' : 
                                  this.classList.contains('medium') ? 'medium' : 
                                  this.classList.contains('hard') ? 'hard' : 'all';
                
                // ç­›é€‰é¢˜ç›®
                const rows = document.querySelectorAll('.problem-table tbody tr');
                rows.forEach(row => {
                  if (difficulty === 'all' || row.classList.contains(`difficulty-${difficulty}`)) {
                    row.style.display = '';
                  } else {
                    row.style.display = 'none';
                  }
                });
              });
            });
          }
          EOL
          
          # æ›´æ–°index.htmlä»¥å¼•ç”¨æ–°çš„èµ„æºæ–‡ä»¶
          sed -i 's|</head>|<link rel="stylesheet" href="./styles.css"></head>|' dist/index.html
          sed -i 's|</body>|<script src="./app.js"></script></body>|' dist/index.html
          
          # åˆ›å»º404é¡µé¢
          cp dist/index.html dist/404.html
          
          echo "æ„å»ºç›®å½•å†…å®¹:"
          ls -la dist
        
      - name: Deploy to GitHub Pages ğŸš€
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          folder: dist
          branch: gh-pages
          clean: true
          token: ${{ secrets.GITHUB_TOKEN }} 